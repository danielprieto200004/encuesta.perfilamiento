<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realizando Test | UNIMINUTO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 25%, #3b82f6 50%, #2563eb 75%, #1d4ed8 100%); background-size: 400% 400%; animation: gradientShift 15s ease infinite; min-height: 100vh; position: relative; }
        body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(59, 130, 246, 0.2) 0%, transparent 50%); pointer-events: none; z-index: -1; }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        #questionContainer { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .question-card, .section-header { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.3); }
        .question-changing { opacity: 0; transform: scale(0.95); }
        .option-btn { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border: 2px solid rgba(59, 130, 246, 0.2); }
        .option-btn:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(59, 130, 246, 0.2); border-color: #3B82F6; }
        .option-btn.selected { background: linear-gradient(135deg, #1E40AF, #3B82F6); color: white; border-color: #1E40AF; transform: translateY(-3px); box-shadow: 0 15px 35px rgba(30, 64, 175, 0.3); }
        .progress-bar-fill { transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1); background: linear-gradient(90deg, #3B82F6, #1E40AF, #7C3AED); }
        .floating-element { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .pulse-animation { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .gradient-text { background: linear-gradient(135deg, #1E40AF, #7C3AED); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .submit-btn-ready { background: linear-gradient(135deg, #10B981, #059669); animation: readyPulse 2s infinite; }
        @keyframes readyPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 50% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); } }
    </style>
</head>
<body class="text-gray-800">

    <header class="glass-effect shadow-2xl p-4 md:p-6 sticky top-0 z-20">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4 md:gap-0">
            <div class="flex items-center space-x-4 floating-element">
                <div class="relative">
                    <svg class="h-10 w-10 md:h-12 md:w-12 text-blue-700" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" /></svg>
                    <div class="absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full pulse-animation"></div>
                </div>
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold gradient-text">UNIMINUTO</h1>
                    <p class="text-xs md:text-sm text-gray-600 font-medium">Observatorio Experimental</p>
                </div>
            </div>
            <div class="text-center md:text-right">
                <span class="font-bold text-base md:text-lg gradient-text">Test de Perfilamiento</span>
                <p class="text-xs md:text-sm text-gray-600">Paso 2: Cuestionario</p>
            </div>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-3 mt-4 md:mt-6 overflow-hidden">
            <div id="progressBar" class="progress-bar-fill h-3 rounded-full" style="width: 0%"></div>
        </div>
        <div class="flex justify-between text-xs text-white mt-2 font-semibold">
            <span>Inicio</span>
            <span id="progressText">0% completado</span>
            <span>Fin</span>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <div id="questionContainer" class="max-w-4xl mx-auto" style="opacity: 0; transform: translateY(30px);">
            <div class="section-header p-6 md:p-8 rounded-2xl shadow-xl mb-6 md:mb-8">
                <div class="flex flex-col sm:flex-row justify-between items-center text-center sm:text-left gap-4">
                    <div class="flex items-center space-x-4">
                        <div id="sectionIcon" class="w-12 h-12 md:w-16 md:h-16 rounded-2xl flex items-center justify-center flex-shrink-0"></div>
                        <div>
                            <h3 id="sectionTitle" class="text-xl sm:text-2xl md:text-3xl font-bold gradient-text"></h3>
                            <p id="sectionDescription" class="text-gray-600 mt-1 text-sm md:text-lg"></p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div id="sectionCounter" class="px-4 py-2 rounded-xl">
                            <span id="currentQuestionNum" class="text-xl md:text-2xl font-bold"></span>
                            <span class="text-gray-600">/</span>
                            <span id="totalQuestions" class="text-xl md:text-2xl font-bold">60</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="questionCard" class="question-card p-6 md:p-10 rounded-2xl shadow-2xl mb-8 flex flex-col justify-center">
                <h4 id="questionText" class="text-xl md:text-2xl font-bold text-gray-800 mb-8 text-center leading-relaxed"></h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                    <button id="optionA" type="button" class="option-btn p-4 md:p-6 rounded-xl flex items-center space-x-4"><div class="w-10 h-10 bg-blue-100 rounded-full flex-shrink-0 flex items-center justify-center"><span class="font-bold text-blue-600 text-xl">A</span></div><span id="optionAText" class="text-base md:text-lg text-left"></span></button>
                    <button id="optionB" type="button" class="option-btn p-4 md:p-6 rounded-xl flex items-center space-x-4"><div class="w-10 h-10 bg-blue-100 rounded-full flex-shrink-0 flex items-center justify-center"><span class="font-bold text-blue-600 text-xl">B</span></div><span id="optionBText" class="text-base md:text-lg text-left"></span></button>
                </div>
            </div>

            <div id="finalSubmit" class="text-center mt-12" style="display: none;">
                <div class="glass-effect p-6 md:p-8 rounded-2xl shadow-2xl inline-block">
                    <h3 class="text-2xl md:text-3xl font-bold gradient-text mb-4">¡Test Completado!</h3>
                    <p class="text-gray-600 mb-6">Estás listo para ver tus resultados.</p>
                    <button id="submitBtn" type="button" class="submit-btn-ready text-white font-bold py-4 px-10 md:py-5 md:px-12 rounded-2xl text-xl md:text-2xl">
                        ¡Descubre tu perfil!
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- DATA STORE ---
        const surveyData = {
            diagrams: [
                { id: 'd1', questions: [ { q: 'A la hora de elegir tus materias electivas, ¿qué pesa más en tu decisión?', a: 'La que me enseñe una habilidad específica muy demandada en el mercado laboral.', b: 'La que despierte mi curiosidad y me permita explorar un tema nuevo.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Para ti, ¿qué significa que un profesor es "excelente"?', a: 'Que tiene experiencia en la industria y enfoca sus clases en las habilidades que las empresas necesitan.', b: 'Que inspira a pensar críticamente, fomenta el debate y se preocupa por el desarrollo personal.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Qué tipo de evaluación te parece más representativa de tu aprendizaje?', a: 'Una que me permita demostrar mi capacidad de investigar y proponer soluciones originales.', b: 'Una que mida mi conocimiento sobre los temas vistos en clase a través de preguntas claras.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué momento de una clase presencial consideras más valioso?', a: 'El debate espontáneo que surge y enriquece el tema desde múltiples perspectivas.', b: 'La explicación del profesor que se enfoca en la aplicación práctica para el trabajo.', val_a: {x:-1, y:0}, val_b: {x:1, y:0} }, { q: 'Piensa en tu principal objetivo al terminar la universidad. ¿Con cuál de estas frases te identificas más?', a: '"Asegurar un camino claro hacia la estabilidad y un buen salario, aunque deba enfocarme solo en lo profesional".', b: '"Formarme como una persona con una visión más amplia, aunque el camino profesional sea menos directo".', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Imagina que tienes dos ofertas para una práctica universitaria. ¿Cuál eliges?', a: 'Una en una startup competitiva con aprendizaje acelerado y autonomía, aunque la carga de trabajo sea alta y exija disponibilidad fuera de horarios.', b: 'Una en una organización con un plan de formación estructurado, un horario fijo que respeta mi tiempo personal y un tutor asignado.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: 'La universidad ofrece dos programas de intercambio internacional. ¿Cuál te llama más la atención?', a: 'Un programa enfocado en una pasantía intensiva en una empresa multinacional.', b: 'Un programa de voluntariado en una comunidad para el intercambio cultural y desarrollo social.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: '¿Qué habilidad crees que es más crucial desarrollar en la U para tu futuro?', a: 'Dominar un software o una técnica muy específica de mi campo.', b: 'Aprender a comunicarme efectivamente y a trabajar en equipos diversos.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Qué tipo de evento profesional te atrae más?', a: 'Una feria de empleo, enfocada en la eficiencia de entregar mi hoja de vida y conseguir entrevistas.', b: 'Un conversatorio con egresados para inspirarme, aunque no ofrezca una oportunidad laboral inmediata.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Si tuvieras una tarde libre en el campus, ¿qué actividad preferirías?', a: 'Asistir a una charla con un gerente de una empresa importante sobre tendencias del mercado.', b: 'Participar en un taller de escritura creativa o en un cine-foro para discutir una película.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Un grupo estudiantil te invita a participar. ¿Cuál de estas dos propuestas te atrae más?', a: 'Un grupo para desarrollar proyectos de emprendimiento, que exige alta dedicación para competir y buscar financiación.', b: 'Un grupo de apoyo y bienestar, donde el foco es crear lazos de amistad y un ambiente de soporte mutuo.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: 'Al final de tu carrera, ¿qué logro te haría sentir más orgulloso/a?', a: 'Haber desarrollado un proyecto innovador, asumiendo el riesgo de invertir tiempo y recursos propios para materializarlo.', b: 'Ser reconocido/a por mis profesores por mi excelencia, abriendo puertas a becas de posgrado o recomendaciones laborales.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: '¿Qué es lo más valioso que te llevas de un día en el campus?', a: 'La sensación de pertenecer a una comunidad, invirtiendo tiempo en construir relaciones de amistad y apoyo mutuo.', b: 'Los contactos que hago con personas que pueden ser clave para mi futuro profesional, aunque esto implique ser más estratégico/a.', val_a: {x:-1, y:0}, val_b: {x:1, y:0} }, { q: 'Cuando te encuentras con un trámite administrativo complicado, ¿qué sueles hacer primero?', a: 'Intento resolverlo por mi cuenta, buscando la información en la página web.', b: 'Voy directamente a la oficina correspondiente para que un funcionario me explique el proceso.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Te das cuenta de que no entiendes un tema clave para el examen final. ¿Qué haces?', a: 'Dedico varias horas a investigar por mi cuenta. Veo el no entender como un reto personal.', b: 'Organizo un grupo de estudio y le pido al profesor una tutoría extra para que nos refuerce.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué tipo de apoyo preventivo te parece más útil?', a: 'Un taller para mejorar mis hábitos de estudio y organización.', b: 'Un espacio de escucha y apoyo emocional para manejar la presión académica.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué tipo de orientación prefieres?', a: 'Un mentor que me rete y me impulse a salir de mi zona de confort.', b: 'Un tutor que me dé seguridad y me confirme que voy por el camino correcto.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Tu profesor presenta un proyecto final muy abierto, diciendo: "Sorpréndanme". ¿Cuál es tu reacción inicial?', a: '¡Genial! Me encanta la libertad para investigar y proponer algo original por mi cuenta.', b: 'Uff... prefiero buscar al profesor para que me dé lineamientos más claros y ejemplos.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Si tienes una idea para mejorar un proceso en la U, ¿qué haces?', a: 'La desarrollo y la presento formalmente, asumiendo el liderazgo y el trabajo extra que esto implica.', b: 'La comparto en los canales oficiales, confiando en que las estructuras existentes la procesen adecuadamente.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Un proyecto en el que trabajaste mucho no da los resultados esperados. ¿Cómo lo ves?', a: 'Como una oportunidad de aprendizaje valiosa para entender qué falló y mejorar.', b: 'Como una frustración que me hace dudar de si debería tomar tantos riesgos.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, ] },
                { id: 'd2', questions: [ { q: 'Prefieres un curso que se base principalmente en...', a: 'un gran proyecto semestral que te reta a integrar y aplicar conocimientos sobre un caso real.', b: 'módulos temáticos secuenciales, con talleres y evaluaciones que aseguran el dominio de cada concepto.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Qué profesor consideras que te prepara mejor?', a: 'El que resuelve en clase muchos ejercicios prácticos tipo examen, asegurando que sepas cómo aplicar los conceptos.', b: 'El que te hace entender la teoría a la perfección, confiando en que tú encontrarás la forma de aplicarla.', val_a: {x:1, y:-1}, val_b: {x:-1, y:1} }, { q: '¿Cómo prefieres recibir la retroalimentación de un proyecto?', a: 'Comentarios puntuales y frecuentes durante todo el proceso para poder corregir sobre la marcha.', b: 'Una evaluación final detallada que me permita ver el resultado global y aprender de él para el futuro.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: '¿Qué situación te generaría más frustración a largo plazo?', a: 'Pasar un curso sin mucho esfuerzo, pero luego sentir que no tienes las bases sólidas para el siguiente.', b: 'Estudiar muchísimo y sentir que aprendiste un montón, pero que la nota final no lo refleje.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: '¿Qué tipo de conocimiento crees que te servirá más en tu primer trabajo?', a: 'El dominio de herramientas y procesos prácticos que pueda usar desde el primer día.', b: 'Una base conceptual sólida que me permita entender el porqué de las cosas y adaptarme a futuros cambios.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'En una entrevista de trabajo, ¿qué preferirías demostrar?', a: 'Un portafolio con proyectos y resultados concretos que he construido.', b: 'Mi capacidad para analizar problemas complejos desde una perspectiva teórica y estratégica.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Qué tipo de taller extracurricular te parece más útil?', a: 'Uno para aprender a usar un software específico de tu carrera, con un certificado al final.', b: 'Uno sobre pensamiento crítico y argumentación, con debates abiertos y sin una evaluación formal.', val_a: {x:1, y:-1}, val_b: {x:-1, y:1} }, { q: 'Si te unes a un club académico, ¿cuál eliges?', a: 'Un club de robótica o programación para construir, competir y ver resultados tangibles.', b: 'Un club de lectura o filosofía para debatir sobre grandes obras, ideas y sus implicaciones.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Qué tipo de conversación académica disfrutas más con amigos?', a: 'Discutir cómo aplicar lo visto en clase para resolver un problema del mundo real.', b: 'Debatir sobre las implicaciones filosóficas o éticas de una teoría que vieron en clase.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Si buscas ayuda en una tutoría, ¿qué esperas?', a: 'Que me guíen paso a paso para resolver los ejercicios específicos que no entiendo.', b: 'Que me recomienden libros y fuentes para que pueda investigar y entender el tema por mi cuenta.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: '¿Qué tipo de recurso en línea usas más para estudiar?', a: 'Videos tutoriales oficiales que explican un tema de forma clara y secuencial.', b: 'Foros donde otros estudiantes y expertos debaten y resuelven dudas de forma colaborativa.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: '¿Qué tipo de guía de un profesor valoras más a largo plazo?', a: 'La de un profesor exigente que te señala tus errores sin rodeos para forzarte a mejorar y a ser más autónomo/a.', b: 'La de un profesor que te acompaña de cerca, te da confianza y te ofrece una estructura de apoyo constante.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Para ti, innovar en la universidad es...', a: 'crear un prototipo, un plan de negocio o un producto que funcione y resuelva un problema práctico.', b: 'desarrollar un nuevo modelo teórico o un ensayo que ofrezca una perspectiva original sobre un tema.', val_a: {x:1, y:1}, val_b: {x:-1, y:1} }, { q: '¿Cómo organizas tu tiempo de estudio?', a: 'Me gusta tener un plan de estudio detallado con metas diarias y horarios fijos para cada materia.', b: 'Estudio de forma más orgánica, profundizando en los temas que más me interesan en el momento.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: 'Ante un problema sin solución clara, ¿qué haces primero?', a: 'Busco metodologías y casos prácticos que otros han usado para tener una base aplicable.', b: 'Empiezo a experimentar con diferentes enfoques conceptuales, aceptando que puedo cometer errores en el proceso.', val_a: {x:1, y:-1}, val_b: {x:-1, y:1} }, { q: '¿Qué tipo de examen final prefieres?', a: 'Uno con preguntas abiertas donde puedes demostrar tu comprensión con tus propias palabras, aunque la calificación sea más subjetiva.', b: 'Uno con problemas y preguntas con puntaje definido, donde las reglas de calificación son claras y objetivas.', val_a: {x:-1, y:1}, val_b: {x:1, y:-1} }, { q: '¿Qué te motiva más a aprender?', a: 'La posibilidad de construir algo con mis propias manos y ver que funciona.', b: 'La satisfacción de comprender a fondo una idea abstracta y sus implicaciones.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Un profesor te da la opción de...', a: 'seguir un tutorial detallado para aprender una nueva habilidad y asegurar un resultado correcto.', b: 'experimentar libremente con una nueva tecnología, aunque no haya una guía y el resultado sea incierto.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: '¿Qué tipo de trabajo en grupo prefieres?', a: 'Uno donde los roles y las tareas de cada integrante están claramente definidos desde el principio.', b: 'Uno donde el equipo explora el problema de forma conjunta y los roles y soluciones surgen orgánicamente.', val_a: {x:0, y:-1}, val_b: {x:0, y:1} }, { q: '¿Qué es más importante en un syllabus para ti?', a: 'Que los objetivos de aprendizaje sean prácticos y las evaluaciones estén claramente definidas.', b: 'Que la bibliografía sea profunda y los temas inviten a la exploración independiente.', val_a: {x:1, y:-1}, val_b: {x:-1, y:1} }, ] },
                { id: 'd3', questions: [ { q: '¿Qué valoras más de un trabajo en grupo?', a: 'Trabajar con los compañeros más capaces, aunque la dinámica sea competitiva, para asegurar la mejor nota y aprender de los mejores.', b: 'Trabajar con mis amigos, aunque no sean los más expertos, para asegurar un buen ambiente y apoyarnos mutuamente.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: 'Un profesor invita a un ponente externo. ¿Qué te parece más interesante?', a: 'Que sea un alto ejecutivo de una empresa líder para hacer contactos valiosos.', b: 'Que sea un líder social o un artista que inspire una reflexión profunda en la comunidad.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Cuál es tu principal objetivo al asistir a un evento universitario?', a: 'Identificar y conversar con personas (profesores, ponentes) que puedan potenciar mi carrera.', b: 'Relajarme y compartir un buen rato con mi círculo de amigos cercanos.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: '¿Qué tipo de programa de mentoría prefieres?', a: 'Uno con un egresado exitoso en mi campo, enfocado en consejos de carrera y networking.', b: 'Uno con un estudiante de semestres avanzados, enfocado en el apoyo académico y la adaptación a la vida universitaria.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Cómo usas tus redes sociales en el contexto universitario?', a: 'Principalmente para construir un perfil profesional (ej. LinkedIn) y seguir a líderes de la industria.', b: 'Principalmente para mantenerme en contacto con mis amigos y enterarme de eventos sociales y de bienestar.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Qué te motivaría a ser voluntario en un evento de la universidad?', a: 'La posibilidad de tener un rol visible y conocer a los organizadores y ponentes importantes.', b: 'La oportunidad de colaborar con mis amigos en una causa común y fortalecer nuestros lazos.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: '¿Qué tipo de evento social prefieres?', a: 'Una fiesta grande o un concierto con toda la facultad, ideal para conocer mucha gente nueva.', b: 'Una reunión pequeña en la cafetería o una salida a comer con tu grupo de amigos de siempre.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Cuando llegas a un lugar concurrido en el campus, ¿qué haces?', a: 'Me muevo entre diferentes grupos, saludando a varias personas y participando en distintas conversaciones.', b: 'Busco un lugar tranquilo o me siento con las una o dos personas con las que tengo más confianza.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué te haría sentir más satisfecho/a?', a: 'Organizar un gran evento que tenga un impacto masivo y sea recordado por todos en la universidad.', b: 'Ser la persona a la que un amigo acude cuando necesita un consejo o apoyo incondicional.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué es más importante para ti en la vida universitaria?', a: 'Construir una amplia red de contactos que me sirva profesionalmente, aunque las relaciones sean más superficiales.', b: 'Cultivar unas pocas amistades profundas y significativas, aunque mi red de contactos sea más pequeña.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Cómo te unes a un nuevo grupo o club?', a: 'Investigo cuáles son los más prestigiosos o los que ofrecen mejores oportunidades y me presento activamente.', b: 'Espero a que un amigo me invite o me uno a uno donde ya conozco a varias personas.', val_a: {x:1, y:1}, val_b: {x:-1, y:-1} }, { q: 'Si te sientes abrumado/a, ¿qué buscas?', a: 'Un consejo práctico de un mentor o profesional que me ayude a enfocarme en soluciones para mi carrera.', b: 'El apoyo emocional de mis amigos para desahogarme y sentir que no estoy solo/a en esto.', val_a: {x:1, y:-1}, val_b: {x:-1, y:-1} }, { q: '¿Qué tipo de espacio físico valoras más en el campus?', a: 'Zonas de coworking y salas de reuniones que faciliten la interacción y el trabajo con diversos grupos.', b: 'Zonas de descanso cómodas y silenciosas donde pueda estar solo/a o con un amigo para recargar energías.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué significa "bienestar" para ti en la U?', a: 'Tener las herramientas y contactos para sentir seguridad y confianza en mi futuro profesional.', b: 'Tener un equilibrio saludable entre lo académico y lo personal, con una red de apoyo emocional fuerte.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Cómo prefieres enterarte de las actividades de la U?', a: 'A través de boletines oficiales y redes profesionales para filtrar las oportunidades más relevantes para mi carrera.', b: 'A través de los grupos de WhatsApp con mis amigos y las conversaciones en los pasillos.', val_a: {x:1, y:-1}, val_b: {x:-1, y:-1} }, { q: 'Al iniciar cada semestre, ¿cuál es tu mentalidad principal?', a: '"Aprovecharé para conocer gente nueva, participar en eventos y ampliar mis experiencias más allá de lo académico".', b: '"Vengo a lo mío: me enfocaré en mis clases y en estudiar, las relaciones sociales ya se darán con el tiempo".', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué tipo de liderazgo te resulta más natural?', a: 'Tomar la iniciativa en proyectos, organizar equipos y presentar los resultados frente a audiencias.', b: 'Apoyar al equipo desde un rol más discreto, asegurando que todos se sientan incluidos y escuchados.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, { q: 'Es la final del torneo de la facultad y coincide con una clase que tiene un quiz de bajo puntaje. ¿Qué haces?', a: 'Priorizo mi responsabilidad académica y asisto a clase, aunque me duela perderme la final.', b: 'Juego la final. Es un momento único para el equipo y la comunidad, y asumo el riesgo del quiz.', val_a: {x:1, y:0}, val_b: {x:-1, y:0} }, { q: '¿Cuál es tu postura frente a la política estudiantil (representantes, consejos, etc.)?', a: 'Me involucro. Es una oportunidad clave para generar impacto y establecer relaciones con las directivas.', b: 'No me involucro, pero valoro que otros lo hagan. Prefiero enfocarme 100% en mis estudios y proyectos.', val_a: {x:1, y:1}, val_b: {x:0, y:-1} }, { q: '¿Qué define mejor tu forma de socializar?', a: 'Soy como un "explorador": me gusta conocer gente diversa y adaptarme a diferentes ambientes sociales.', b: 'Soy como un "jardinero": prefiero cuidar y profundizar las pocas relaciones que ya tengo.', val_a: {x:0, y:1}, val_b: {x:0, y:-1} }, ] }
            ],
            answers: {}
        };

        document.addEventListener('DOMContentLoaded', () => {
            let currentQuestionIndex = 0;
            let allQuestions = [];
            
            surveyData.diagrams.forEach((diagram, diagramIndex) => {
                diagram.questions.forEach((question, questionIndex) => {
                    allQuestions.push({
                        ...question,
                        diagramIndex,
                        questionId: `${diagram.id}-q${questionIndex}`
                    });
                    surveyData.answers[`${diagram.id}-q${questionIndex}`] = null;
                });
            });

            // DOM Elements
            const qContainer = document.getElementById('questionContainer');
            const qText = document.getElementById('questionText');
            const optA = document.getElementById('optionA');
            const optB = document.getElementById('optionB');
            const optAText = document.getElementById('optionAText');
            const optBText = document.getElementById('optionBText');
            const submitBtn = document.getElementById('submitBtn');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const currentNum = document.getElementById('currentQuestionNum');
            const secTitle = document.getElementById('sectionTitle');
            const secDesc = document.getElementById('sectionDescription');
            const secIcon = document.getElementById('sectionIcon');
            const secCounter = document.getElementById('sectionCounter');
            const finalSubmit = document.getElementById('finalSubmit');

            const sections = [
                { title: 'Tu ADN Estudiantil', description: 'Tu mentalidad y cómo abordas la experiencia universitaria', icon: '🧬', gradient: 'from-blue-500 to-indigo-600', counterClass: 'bg-blue-100', textClass: 'text-blue-700' },
                { title: 'Tu Estilo de Aprendizaje', description: 'Cómo prefieres procesar y aplicar el conocimiento', icon: '✍️', gradient: 'from-purple-500 to-pink-600', counterClass: 'bg-purple-100', textClass: 'text-purple-700' },
                { title: 'Tu Forma de Conectar', description: 'Cómo te relacionas con otros en la universidad', icon: '🤝', gradient: 'from-green-500 to-teal-600', counterClass: 'bg-green-100', textClass: 'text-green-700' }
            ];

            function updateUI() {
                const question = allQuestions[currentQuestionIndex];
                const section = sections[question.diagramIndex];

                qText.textContent = question.q;
                optAText.textContent = question.a;
                optBText.textContent = question.b;
                
                currentNum.textContent = currentQuestionIndex + 1;
                secTitle.textContent = section.title;
                secDesc.textContent = section.description;
                secIcon.innerHTML = `<span class="text-3xl">${section.icon}</span>`;
                secIcon.className = `w-16 h-16 rounded-2xl flex items-center justify-center bg-gradient-to-r ${section.gradient}`;
                secCounter.className = `px-4 py-2 rounded-xl ${section.counterClass}`;
                currentNum.className = `text-2xl font-bold ${section.textClass}`;
                document.getElementById('totalQuestions').className = `text-2xl font-bold ${section.textClass}`;

                const progress = ((currentQuestionIndex) / allQuestions.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `${Math.round(progress)}% completado`;

                optA.classList.remove('selected');
                optB.classList.remove('selected');
            }

            function selectOption(value) {
                surveyData.answers[allQuestions[currentQuestionIndex].questionId] = value;
                const selectedBtn = value === 'a' ? optA : optB;
                selectedBtn.classList.add('selected');

                setTimeout(() => {
                    if (currentQuestionIndex < allQuestions.length - 1) {
                        qContainer.classList.add('question-changing');
                        setTimeout(() => {
                            currentQuestionIndex++;
                            updateUI();
                            qContainer.classList.remove('question-changing');
                        }, 400);
                    } else {
                        // All questions answered
                        progressBar.style.width = `100%`;
                        progressText.textContent = `100% completado`;
                        qContainer.classList.add('question-changing');
                        setTimeout(() => {
                            document.getElementById('questionCard').style.display = 'none';
                            finalSubmit.style.display = 'block';
                            qContainer.classList.remove('question-changing');
                        }, 400);
                    }
                }, 300);
            }

            submitBtn.addEventListener('click', async () => {
                // 1. Obtenemos el id_sesion que guardamos antes
                const id_sesion = sessionStorage.getItem('id_sesion');
                if (!id_sesion) {
                    alert('Error: No se encontró una sesión activa. Por favor, regresa al inicio.');
                    return;
                }

                // 2. Preparamos las respuestas para enviar
                const respuestasParaEnviar = Object.keys(surveyData.answers).map(key => {
                    return { id_pregunta: key, respuesta: surveyData.answers[key] };
                });

                try {
                    // 3. Enviamos las respuestas a la API de Python
                    const response = await fetch('https://api-encuesta-uniminuto.azurewebsites.net/api/guardar-respuestas', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ id_sesion: id_sesion, respuestas: respuestasParaEnviar })
                    });
                    
                    if (!response.ok) {
                    const errorData = await response.json(); // Leer el JSON del error
                    throw new Error('Error del servidor: ' + errorData.error); // Mostrar el error real
                    }

                    // 4. Calculamos los resultados para mostrarlos AL ESTUDIANTE (esto no va a la BD)
                    const results = surveyData.diagrams.map(diagram => {
                        let scoreX = 0;
                        let scoreY = 0;
                        diagram.questions.forEach((q, index) => {
                            const questionId = `${diagram.id}-q${index}`;
                            const answer = surveyData.answers[questionId];
                            if (answer === 'a') {
                                scoreX += q.val_a.x;
                                scoreY += q.val_a.y;
                            } else if (answer === 'b') {
                                scoreX += q.val_b.x;
                                scoreY += q.val_b.y;
                            }
                        });
                        return { diagramId: diagram.id, scoreX, scoreY };
                    });
                    localStorage.setItem('surveyResults', JSON.stringify(results)); // Usamos localStorage para la última página

                    // 5. Redirigimos a la página de resultados
                    window.location.href = 'resultados.html';

                } catch (error) {
                    console.error('Error al guardar respuestas:', error);
                    alert('No se pudieron guardar tus respuestas. Error detallado: ' + error.message);
                }
            });

            optA.addEventListener('click', () => selectOption('a'));
            optB.addEventListener('click', () => selectOption('b'));

            // Initial Load
            if (!sessionStorage.getItem('id_sesion')) { // Verificamos id_sesion en lugar de studentInfo
                alert('No se encontró una sesión activa. Redirigiendo al registro.');
                window.location.href = 'index.html';
            } else {
                updateUI();
                setTimeout(() => {
                    qContainer.style.opacity = '1';
                    qContainer.style.transform = 'translateY(0)';
                }, 100);
            }
        });
    </script>
</body>
</html>

